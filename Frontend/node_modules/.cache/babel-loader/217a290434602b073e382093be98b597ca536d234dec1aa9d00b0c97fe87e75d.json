{"ast":null,"code":"import{put,takeEvery,all}from\"redux-saga/effects\";import axios from\"axios\";import{setSearchResults,setErrorMessage}from\"./homeState\";function extractVideoId(url){const regex=/^(?:https?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtube(?:-nocookie)?\\.com\\/(?:[^\\/\\n\\s]+\\/\\S+\\/|(?:watch\\?|v|e(?:mbed)?)\\/|\\S*?[?&]v=|live\\/|shorts\\/)|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/;// /^(?:https?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtube(?:-nocookie)?\\.com\\/(?:[^\\/\\n\\s]+\\/\\S+\\/|(?:watch\\?|v|e(?:mbed)?)\\/|\\S*?[?&]v=|live\\/)|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/;\nconst match=url.match(regex);return match?match[1]:null;}function*handleSearchSubmit(action){try{const{searchQuery}=action.payload;const API_KEYS=[\"AIzaSyBfE7oaat7qJeMw4BvcKfy54FP4sBU-YTk\",\"AIzaSyDXyPEM65vKoGhdVGWGuSrE4xJWMVZEtxw\",\"AIzaSyD3KFJ4FAEAqd-ABPRyZvUCqGAn-74b1qg\"];let keyIndex=sessionStorage.getItem(\"keyIndex\")||0;// const params = new URLSearchParams(new URL(searchQuery).search);\nconst videoId=extractVideoId(searchQuery);sessionStorage.setItem(\"videoId\",videoId);const response=yield axios.get(\"https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=\".concat(videoId,\"&key=\").concat(API_KEYS[keyIndex]));if(response.data.items.length===0){yield put(setErrorMessage(\"Please enter a valid YouTube video URL.\"));}else{yield put(setSearchResults(response.data.items[0]));}// Rotate the API key for the next request\nkeyIndex=(keyIndex+1)%API_KEYS.length;sessionStorage.setItem(\"keyIndex\",keyIndex);}catch(error){setErrorMessage(\"Please enter a valid YouTube video URL.\");}}export default function*rootSaga(){yield all([takeEvery(\"home/getSearchResults\",handleSearchSubmit)]);}","map":{"version":3,"names":["put","takeEvery","all","axios","setSearchResults","setErrorMessage","extractVideoId","url","regex","match","handleSearchSubmit","action","searchQuery","payload","API_KEYS","keyIndex","sessionStorage","getItem","videoId","setItem","response","get","concat","data","items","length","error","rootSaga"],"sources":["C:/Users/Max4vich/Desktop/freelance/thumbnail_downloader/Frontend/src/redux/home/saga.js"],"sourcesContent":["import { put, takeEvery, all } from \"redux-saga/effects\";\r\nimport axios from \"axios\";\r\nimport { setSearchResults, setErrorMessage } from \"./homeState\";\r\n\r\nfunction extractVideoId(url) {\r\n  const regex =\r\n    /^(?:https?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtube(?:-nocookie)?\\.com\\/(?:[^\\/\\n\\s]+\\/\\S+\\/|(?:watch\\?|v|e(?:mbed)?)\\/|\\S*?[?&]v=|live\\/|shorts\\/)|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/;\r\n  // /^(?:https?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtube(?:-nocookie)?\\.com\\/(?:[^\\/\\n\\s]+\\/\\S+\\/|(?:watch\\?|v|e(?:mbed)?)\\/|\\S*?[?&]v=|live\\/)|youtu\\.be\\/)([a-zA-Z0-9_-]{11})/;\r\n  const match = url.match(regex);\r\n  return match ? match[1] : null;\r\n}\r\n\r\nfunction* handleSearchSubmit(action) {\r\n  try {\r\n    const { searchQuery } = action.payload;\r\n    const API_KEYS = [\r\n      \"AIzaSyBfE7oaat7qJeMw4BvcKfy54FP4sBU-YTk\",\r\n      \"AIzaSyDXyPEM65vKoGhdVGWGuSrE4xJWMVZEtxw\",\r\n      \"AIzaSyD3KFJ4FAEAqd-ABPRyZvUCqGAn-74b1qg\",\r\n    ];\r\n    let keyIndex = sessionStorage.getItem(\"keyIndex\") || 0;\r\n    // const params = new URLSearchParams(new URL(searchQuery).search);\r\n    const videoId = extractVideoId(searchQuery);\r\n\r\n    sessionStorage.setItem(\"videoId\", videoId);\r\n    const response = yield axios.get(\r\n      `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${videoId}&key=${API_KEYS[keyIndex]}`\r\n    );\r\n    if (response.data.items.length === 0) {\r\n      yield put(setErrorMessage(\"Please enter a valid YouTube video URL.\"));\r\n    } else {\r\n      yield put(setSearchResults(response.data.items[0]));\r\n    }\r\n    // Rotate the API key for the next request\r\n    keyIndex = (keyIndex + 1) % API_KEYS.length;\r\n    sessionStorage.setItem(\"keyIndex\", keyIndex);\r\n  } catch (error) {\r\n    setErrorMessage(\"Please enter a valid YouTube video URL.\");\r\n  }\r\n}\r\n\r\nexport default function* rootSaga() {\r\n  yield all([takeEvery(\"home/getSearchResults\", handleSearchSubmit)]);\r\n}\r\n"],"mappings":"AAAA,OAASA,GAAG,CAAEC,SAAS,CAAEC,GAAG,KAAQ,oBAAoB,CACxD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,gBAAgB,CAAEC,eAAe,KAAQ,aAAa,CAE/D,QAAS,CAAAC,cAAcA,CAACC,GAAG,CAAE,CAC3B,KAAM,CAAAC,KAAK,CACT,+KAA+K,CACjL;AACA,KAAM,CAAAC,KAAK,CAAGF,GAAG,CAACE,KAAK,CAACD,KAAK,CAAC,CAC9B,MAAO,CAAAC,KAAK,CAAGA,KAAK,CAAC,CAAC,CAAC,CAAG,IAAI,CAChC,CAEA,SAAUC,kBAAkBA,CAACC,MAAM,CAAE,CACnC,GAAI,CACF,KAAM,CAAEC,WAAY,CAAC,CAAGD,MAAM,CAACE,OAAO,CACtC,KAAM,CAAAC,QAAQ,CAAG,CACf,yCAAyC,CACzC,yCAAyC,CACzC,yCAAyC,CAC1C,CACD,GAAI,CAAAC,QAAQ,CAAGC,cAAc,CAACC,OAAO,CAAC,UAAU,CAAC,EAAI,CAAC,CACtD;AACA,KAAM,CAAAC,OAAO,CAAGZ,cAAc,CAACM,WAAW,CAAC,CAE3CI,cAAc,CAACG,OAAO,CAAC,SAAS,CAAED,OAAO,CAAC,CAC1C,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAAjB,KAAK,CAACkB,GAAG,4EAAAC,MAAA,CAC6CJ,OAAO,UAAAI,MAAA,CAAQR,QAAQ,CAACC,QAAQ,CAAC,CAC9G,CAAC,CACD,GAAIK,QAAQ,CAACG,IAAI,CAACC,KAAK,CAACC,MAAM,GAAK,CAAC,CAAE,CACpC,KAAM,CAAAzB,GAAG,CAACK,eAAe,CAAC,yCAAyC,CAAC,CAAC,CACvE,CAAC,IAAM,CACL,KAAM,CAAAL,GAAG,CAACI,gBAAgB,CAACgB,QAAQ,CAACG,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CACrD,CACA;AACAT,QAAQ,CAAG,CAACA,QAAQ,CAAG,CAAC,EAAID,QAAQ,CAACW,MAAM,CAC3CT,cAAc,CAACG,OAAO,CAAC,UAAU,CAAEJ,QAAQ,CAAC,CAC9C,CAAE,MAAOW,KAAK,CAAE,CACdrB,eAAe,CAAC,yCAAyC,CAAC,CAC5D,CACF,CAEA,cAAe,UAAUsB,QAAQA,CAAA,CAAG,CAClC,KAAM,CAAAzB,GAAG,CAAC,CAACD,SAAS,CAAC,uBAAuB,CAAES,kBAAkB,CAAC,CAAC,CAAC,CACrE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}